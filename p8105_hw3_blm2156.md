p8105\_hw3\_blm2156
================
Britney Mazzetta - blm2156

# Problem 1

``` r
library(tidyverse)
```

    ## ── Attaching packages ──────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.2.1     ✔ purrr   0.3.2
    ## ✔ tibble  2.1.3     ✔ dplyr   0.8.3
    ## ✔ tidyr   1.0.0     ✔ stringr 1.4.0
    ## ✔ readr   1.3.1     ✔ forcats 0.4.0

    ## ── Conflicts ─────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(p8105.datasets)
library(knitr)
data("instacart")
```

## Description of Dataset

There are 1384617 rows in the instacart dataset. There are 15 columns in
the instacart dataset.

There are 134 distinct aisles in the dataset.

## \# of Aisles and Most Popular Aisle

``` r
aisle_info = instacart %>% 
  group_by(aisle_id, aisle) %>%
  summarize(n=n()) %>%
  arrange(desc(n))
```

The aisle in which the most items were ordered from is aisle 83 (fresh
vegetables), with 150609 orders. The aisle in which the second most
items were ordered from is aisle 24 (fresh fruits), with 150473 orders.
The aisle in which the third most items were ordered from is aisle 123
(packaged vegetables fruits), with 78493 orders.

## Instacart Plot

``` r
instacart_plot = filter(aisle_info, n >10000)
ggplot(
  instacart_plot, 
  aes(x = reorder(aisle, -n), y =n)) + 
  geom_point(color = 'blue') +
  theme(axis.text.x = element_text(angle = 90, hjust = 1),
        axis.text = element_text(size = 7.5)) +
  ggtitle("Number of items ordered in each aisle \n(limited to aisles with more than 10,000 items ordered") +
labs(y = "# of Items Ordered",
     x = "Aisle")
```

![](p8105_hw3_blm2156_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

## 3 Most popular items in each aisle

``` r
library(knitr)

ranking = instacart %>%
filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") %>%
  group_by(aisle, product_name)%>%
  summarise(n = n()) %>%
  mutate(product_ranking = min_rank(desc(n))) %>% 
  filter(product_ranking < 4) %>%
  knitr::kable()
  ranking
```

| aisle                      | product\_name                                 |    n | product\_ranking |
| :------------------------- | :-------------------------------------------- | ---: | ---------------: |
| baking ingredients         | Cane Sugar                                    |  336 |                3 |
| baking ingredients         | Light Brown Sugar                             |  499 |                1 |
| baking ingredients         | Pure Baking Soda                              |  387 |                2 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |                2 |
| dog food care              | Small Dog Biscuits                            |   26 |                3 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |                1 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |                1 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |                3 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |                2 |

``` r
mean_hour = instacart %>%
filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_hour_of_day, order_dow)%>%
  summarise(n = n()) %>%
  mutate(mean_hour = mean(order_hour_of_day)) %>% 
  knitr::kable()
  mean_hour
```

| product\_name    | order\_hour\_of\_day | order\_dow |  n | mean\_hour |
| :--------------- | -------------------: | ---------: | -: | ---------: |
| Coffee Ice Cream |                    1 |          5 |  1 |          1 |
| Coffee Ice Cream |                    1 |          6 |  1 |          1 |
| Coffee Ice Cream |                    2 |          5 |  1 |          2 |
| Coffee Ice Cream |                    5 |          1 |  1 |          5 |
| Coffee Ice Cream |                    7 |          1 |  2 |          7 |
| Coffee Ice Cream |                    7 |          2 |  1 |          7 |
| Coffee Ice Cream |                    8 |          0 |  3 |          8 |
| Coffee Ice Cream |                    8 |          5 |  1 |          8 |
| Coffee Ice Cream |                    8 |          6 |  2 |          8 |
| Coffee Ice Cream |                    9 |          0 |  2 |          9 |
| Coffee Ice Cream |                    9 |          1 |  1 |          9 |
| Coffee Ice Cream |                    9 |          2 |  1 |          9 |
| Coffee Ice Cream |                    9 |          3 |  2 |          9 |
| Coffee Ice Cream |                    9 |          4 |  2 |          9 |
| Coffee Ice Cream |                    9 |          5 |  1 |          9 |
| Coffee Ice Cream |                    9 |          6 |  5 |          9 |
| Coffee Ice Cream |                   10 |          0 |  3 |         10 |
| Coffee Ice Cream |                   10 |          5 |  3 |         10 |
| Coffee Ice Cream |                   10 |          6 |  2 |         10 |
| Coffee Ice Cream |                   11 |          0 |  1 |         11 |
| Coffee Ice Cream |                   11 |          1 |  1 |         11 |
| Coffee Ice Cream |                   11 |          2 |  1 |         11 |
| Coffee Ice Cream |                   11 |          3 |  4 |         11 |
| Coffee Ice Cream |                   11 |          4 |  2 |         11 |
| Coffee Ice Cream |                   11 |          5 |  1 |         11 |
| Coffee Ice Cream |                   11 |          6 |  3 |         11 |
| Coffee Ice Cream |                   12 |          1 |  1 |         12 |
| Coffee Ice Cream |                   12 |          2 |  1 |         12 |
| Coffee Ice Cream |                   12 |          4 |  2 |         12 |
| Coffee Ice Cream |                   12 |          5 |  2 |         12 |
| Coffee Ice Cream |                   13 |          0 |  4 |         13 |
| Coffee Ice Cream |                   13 |          2 |  2 |         13 |
| Coffee Ice Cream |                   13 |          3 |  2 |         13 |
| Coffee Ice Cream |                   13 |          4 |  1 |         13 |
| Coffee Ice Cream |                   13 |          5 |  1 |         13 |
| Coffee Ice Cream |                   13 |          6 |  3 |         13 |
| Coffee Ice Cream |                   14 |          0 |  4 |         14 |
| Coffee Ice Cream |                   14 |          1 |  1 |         14 |
| Coffee Ice Cream |                   14 |          2 |  2 |         14 |
| Coffee Ice Cream |                   14 |          3 |  1 |         14 |
| Coffee Ice Cream |                   14 |          4 |  3 |         14 |
| Coffee Ice Cream |                   14 |          5 |  1 |         14 |
| Coffee Ice Cream |                   14 |          6 |  1 |         14 |
| Coffee Ice Cream |                   15 |          0 |  5 |         15 |
| Coffee Ice Cream |                   15 |          1 |  1 |         15 |
| Coffee Ice Cream |                   15 |          2 |  2 |         15 |
| Coffee Ice Cream |                   15 |          3 |  3 |         15 |
| Coffee Ice Cream |                   15 |          4 |  1 |         15 |
| Coffee Ice Cream |                   15 |          5 |  2 |         15 |
| Coffee Ice Cream |                   15 |          6 |  2 |         15 |
| Coffee Ice Cream |                   16 |          0 |  1 |         16 |
| Coffee Ice Cream |                   16 |          1 |  5 |         16 |
| Coffee Ice Cream |                   16 |          3 |  1 |         16 |
| Coffee Ice Cream |                   16 |          4 |  3 |         16 |
| Coffee Ice Cream |                   16 |          5 |  1 |         16 |
| Coffee Ice Cream |                   16 |          6 |  5 |         16 |
| Coffee Ice Cream |                   17 |          0 |  3 |         17 |
| Coffee Ice Cream |                   17 |          1 |  3 |         17 |
| Coffee Ice Cream |                   17 |          2 |  4 |         17 |
| Coffee Ice Cream |                   17 |          3 |  1 |         17 |
| Coffee Ice Cream |                   17 |          4 |  4 |         17 |
| Coffee Ice Cream |                   17 |          5 |  1 |         17 |
| Coffee Ice Cream |                   17 |          6 |  7 |         17 |
| Coffee Ice Cream |                   18 |          0 |  1 |         18 |
| Coffee Ice Cream |                   18 |          2 |  4 |         18 |
| Coffee Ice Cream |                   18 |          3 |  2 |         18 |
| Coffee Ice Cream |                   18 |          4 |  1 |         18 |
| Coffee Ice Cream |                   18 |          6 |  1 |         18 |
| Coffee Ice Cream |                   19 |          0 |  4 |         19 |
| Coffee Ice Cream |                   19 |          1 |  1 |         19 |
| Coffee Ice Cream |                   19 |          2 |  1 |         19 |
| Coffee Ice Cream |                   19 |          3 |  2 |         19 |
| Coffee Ice Cream |                   19 |          5 |  2 |         19 |
| Coffee Ice Cream |                   19 |          6 |  1 |         19 |
| Coffee Ice Cream |                   20 |          2 |  1 |         20 |
| Coffee Ice Cream |                   20 |          3 |  2 |         20 |
| Coffee Ice Cream |                   20 |          4 |  2 |         20 |
| Coffee Ice Cream |                   20 |          5 |  1 |         20 |
| Coffee Ice Cream |                   20 |          6 |  1 |         20 |
| Coffee Ice Cream |                   21 |          1 |  2 |         21 |
| Coffee Ice Cream |                   21 |          2 |  1 |         21 |
| Coffee Ice Cream |                   21 |          3 |  1 |         21 |
| Coffee Ice Cream |                   21 |          4 |  2 |         21 |
| Coffee Ice Cream |                   21 |          6 |  1 |         21 |
| Coffee Ice Cream |                   22 |          3 |  1 |         22 |
| Coffee Ice Cream |                   23 |          6 |  1 |         23 |
| Pink Lady Apples |                    0 |          4 |  1 |          0 |
| Pink Lady Apples |                    3 |          5 |  1 |          3 |
| Pink Lady Apples |                    5 |          2 |  1 |          5 |
| Pink Lady Apples |                    5 |          5 |  1 |          5 |
| Pink Lady Apples |                    6 |          0 |  1 |          6 |
| Pink Lady Apples |                    6 |          1 |  2 |          6 |
| Pink Lady Apples |                    6 |          2 |  2 |          6 |
| Pink Lady Apples |                    6 |          4 |  1 |          6 |
| Pink Lady Apples |                    6 |          6 |  1 |          6 |
| Pink Lady Apples |                    7 |          0 |  1 |          7 |
| Pink Lady Apples |                    7 |          1 |  1 |          7 |
| Pink Lady Apples |                    7 |          2 |  6 |          7 |
| Pink Lady Apples |                    7 |          4 |  1 |          7 |
| Pink Lady Apples |                    7 |          5 |  1 |          7 |
| Pink Lady Apples |                    7 |          6 |  2 |          7 |
| Pink Lady Apples |                    8 |          0 |  2 |          8 |
| Pink Lady Apples |                    8 |          1 |  6 |          8 |
| Pink Lady Apples |                    8 |          2 |  3 |          8 |
| Pink Lady Apples |                    8 |          3 |  1 |          8 |
| Pink Lady Apples |                    8 |          4 |  1 |          8 |
| Pink Lady Apples |                    8 |          5 |  5 |          8 |
| Pink Lady Apples |                    9 |          0 |  2 |          9 |
| Pink Lady Apples |                    9 |          1 | 11 |          9 |
| Pink Lady Apples |                    9 |          2 |  5 |          9 |
| Pink Lady Apples |                    9 |          3 |  3 |          9 |
| Pink Lady Apples |                    9 |          4 |  3 |          9 |
| Pink Lady Apples |                    9 |          5 |  6 |          9 |
| Pink Lady Apples |                    9 |          6 |  1 |          9 |
| Pink Lady Apples |                   10 |          0 |  4 |         10 |
| Pink Lady Apples |                   10 |          1 |  9 |         10 |
| Pink Lady Apples |                   10 |          2 |  5 |         10 |
| Pink Lady Apples |                   10 |          3 |  5 |         10 |
| Pink Lady Apples |                   10 |          4 |  4 |         10 |
| Pink Lady Apples |                   10 |          5 |  4 |         10 |
| Pink Lady Apples |                   10 |          6 |  1 |         10 |
| Pink Lady Apples |                   11 |          0 |  4 |         11 |
| Pink Lady Apples |                   11 |          1 |  5 |         11 |
| Pink Lady Apples |                   11 |          2 |  5 |         11 |
| Pink Lady Apples |                   11 |          3 |  5 |         11 |
| Pink Lady Apples |                   11 |          4 |  4 |         11 |
| Pink Lady Apples |                   11 |          5 |  5 |         11 |
| Pink Lady Apples |                   11 |          6 |  3 |         11 |
| Pink Lady Apples |                   12 |          0 |  2 |         12 |
| Pink Lady Apples |                   12 |          1 |  3 |         12 |
| Pink Lady Apples |                   12 |          2 |  3 |         12 |
| Pink Lady Apples |                   12 |          3 |  2 |         12 |
| Pink Lady Apples |                   12 |          4 |  4 |         12 |
| Pink Lady Apples |                   12 |          5 |  2 |         12 |
| Pink Lady Apples |                   12 |          6 |  1 |         12 |
| Pink Lady Apples |                   13 |          0 |  3 |         13 |
| Pink Lady Apples |                   13 |          1 |  4 |         13 |
| Pink Lady Apples |                   13 |          2 |  1 |         13 |
| Pink Lady Apples |                   13 |          3 |  3 |         13 |
| Pink Lady Apples |                   13 |          4 |  1 |         13 |
| Pink Lady Apples |                   13 |          5 |  3 |         13 |
| Pink Lady Apples |                   13 |          6 |  2 |         13 |
| Pink Lady Apples |                   14 |          0 |  2 |         14 |
| Pink Lady Apples |                   14 |          2 |  5 |         14 |
| Pink Lady Apples |                   14 |          3 |  2 |         14 |
| Pink Lady Apples |                   14 |          4 |  3 |         14 |
| Pink Lady Apples |                   14 |          5 |  5 |         14 |
| Pink Lady Apples |                   14 |          6 |  1 |         14 |
| Pink Lady Apples |                   15 |          0 |  5 |         15 |
| Pink Lady Apples |                   15 |          2 |  3 |         15 |
| Pink Lady Apples |                   15 |          4 |  1 |         15 |
| Pink Lady Apples |                   15 |          5 |  4 |         15 |
| Pink Lady Apples |                   16 |          0 |  1 |         16 |
| Pink Lady Apples |                   16 |          1 |  4 |         16 |
| Pink Lady Apples |                   16 |          2 |  2 |         16 |
| Pink Lady Apples |                   16 |          4 |  3 |         16 |
| Pink Lady Apples |                   16 |          5 |  4 |         16 |
| Pink Lady Apples |                   16 |          6 |  2 |         16 |
| Pink Lady Apples |                   17 |          2 |  1 |         17 |
| Pink Lady Apples |                   17 |          3 |  2 |         17 |
| Pink Lady Apples |                   17 |          4 |  1 |         17 |
| Pink Lady Apples |                   17 |          5 |  5 |         17 |
| Pink Lady Apples |                   17 |          6 |  1 |         17 |
| Pink Lady Apples |                   18 |          2 |  1 |         18 |
| Pink Lady Apples |                   18 |          3 |  1 |         18 |
| Pink Lady Apples |                   18 |          6 |  1 |         18 |
| Pink Lady Apples |                   19 |          0 |  1 |         19 |
| Pink Lady Apples |                   19 |          1 |  1 |         19 |
| Pink Lady Apples |                   19 |          2 |  1 |         19 |
| Pink Lady Apples |                   19 |          5 |  1 |         19 |
| Pink Lady Apples |                   20 |          0 |  2 |         20 |
| Pink Lady Apples |                   20 |          1 |  1 |         20 |
| Pink Lady Apples |                   20 |          3 |  1 |         20 |
| Pink Lady Apples |                   20 |          4 |  1 |         20 |
| Pink Lady Apples |                   21 |          0 |  3 |         21 |
| Pink Lady Apples |                   21 |          1 |  1 |         21 |
| Pink Lady Apples |                   21 |          2 |  1 |         21 |
| Pink Lady Apples |                   21 |          3 |  2 |         21 |
| Pink Lady Apples |                   21 |          5 |  2 |         21 |
| Pink Lady Apples |                   22 |          0 |  1 |         22 |
| Pink Lady Apples |                   22 |          1 |  1 |         22 |
| Pink Lady Apples |                   22 |          3 |  4 |         22 |
| Pink Lady Apples |                   22 |          5 |  1 |         22 |
| Pink Lady Apples |                   23 |          1 |  1 |         23 |
| Pink Lady Apples |                   23 |          2 |  2 |         23 |
| Pink Lady Apples |                   23 |          3 |  1 |         23 |
| Pink Lady Apples |                   23 |          5 |  1 |         23 |

``` r
  mean_hour = instacart %>%
filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
group_by(product_name, order_hour_of_day, order_dow)%>%
  summarise(mean(order_hour_of_day)) %>%
  knitr::kable()
  mean_hour
```

| product\_name    | order\_hour\_of\_day | order\_dow | mean(order\_hour\_of\_day) |
| :--------------- | -------------------: | ---------: | -------------------------: |
| Coffee Ice Cream |                    1 |          5 |                          1 |
| Coffee Ice Cream |                    1 |          6 |                          1 |
| Coffee Ice Cream |                    2 |          5 |                          2 |
| Coffee Ice Cream |                    5 |          1 |                          5 |
| Coffee Ice Cream |                    7 |          1 |                          7 |
| Coffee Ice Cream |                    7 |          2 |                          7 |
| Coffee Ice Cream |                    8 |          0 |                          8 |
| Coffee Ice Cream |                    8 |          5 |                          8 |
| Coffee Ice Cream |                    8 |          6 |                          8 |
| Coffee Ice Cream |                    9 |          0 |                          9 |
| Coffee Ice Cream |                    9 |          1 |                          9 |
| Coffee Ice Cream |                    9 |          2 |                          9 |
| Coffee Ice Cream |                    9 |          3 |                          9 |
| Coffee Ice Cream |                    9 |          4 |                          9 |
| Coffee Ice Cream |                    9 |          5 |                          9 |
| Coffee Ice Cream |                    9 |          6 |                          9 |
| Coffee Ice Cream |                   10 |          0 |                         10 |
| Coffee Ice Cream |                   10 |          5 |                         10 |
| Coffee Ice Cream |                   10 |          6 |                         10 |
| Coffee Ice Cream |                   11 |          0 |                         11 |
| Coffee Ice Cream |                   11 |          1 |                         11 |
| Coffee Ice Cream |                   11 |          2 |                         11 |
| Coffee Ice Cream |                   11 |          3 |                         11 |
| Coffee Ice Cream |                   11 |          4 |                         11 |
| Coffee Ice Cream |                   11 |          5 |                         11 |
| Coffee Ice Cream |                   11 |          6 |                         11 |
| Coffee Ice Cream |                   12 |          1 |                         12 |
| Coffee Ice Cream |                   12 |          2 |                         12 |
| Coffee Ice Cream |                   12 |          4 |                         12 |
| Coffee Ice Cream |                   12 |          5 |                         12 |
| Coffee Ice Cream |                   13 |          0 |                         13 |
| Coffee Ice Cream |                   13 |          2 |                         13 |
| Coffee Ice Cream |                   13 |          3 |                         13 |
| Coffee Ice Cream |                   13 |          4 |                         13 |
| Coffee Ice Cream |                   13 |          5 |                         13 |
| Coffee Ice Cream |                   13 |          6 |                         13 |
| Coffee Ice Cream |                   14 |          0 |                         14 |
| Coffee Ice Cream |                   14 |          1 |                         14 |
| Coffee Ice Cream |                   14 |          2 |                         14 |
| Coffee Ice Cream |                   14 |          3 |                         14 |
| Coffee Ice Cream |                   14 |          4 |                         14 |
| Coffee Ice Cream |                   14 |          5 |                         14 |
| Coffee Ice Cream |                   14 |          6 |                         14 |
| Coffee Ice Cream |                   15 |          0 |                         15 |
| Coffee Ice Cream |                   15 |          1 |                         15 |
| Coffee Ice Cream |                   15 |          2 |                         15 |
| Coffee Ice Cream |                   15 |          3 |                         15 |
| Coffee Ice Cream |                   15 |          4 |                         15 |
| Coffee Ice Cream |                   15 |          5 |                         15 |
| Coffee Ice Cream |                   15 |          6 |                         15 |
| Coffee Ice Cream |                   16 |          0 |                         16 |
| Coffee Ice Cream |                   16 |          1 |                         16 |
| Coffee Ice Cream |                   16 |          3 |                         16 |
| Coffee Ice Cream |                   16 |          4 |                         16 |
| Coffee Ice Cream |                   16 |          5 |                         16 |
| Coffee Ice Cream |                   16 |          6 |                         16 |
| Coffee Ice Cream |                   17 |          0 |                         17 |
| Coffee Ice Cream |                   17 |          1 |                         17 |
| Coffee Ice Cream |                   17 |          2 |                         17 |
| Coffee Ice Cream |                   17 |          3 |                         17 |
| Coffee Ice Cream |                   17 |          4 |                         17 |
| Coffee Ice Cream |                   17 |          5 |                         17 |
| Coffee Ice Cream |                   17 |          6 |                         17 |
| Coffee Ice Cream |                   18 |          0 |                         18 |
| Coffee Ice Cream |                   18 |          2 |                         18 |
| Coffee Ice Cream |                   18 |          3 |                         18 |
| Coffee Ice Cream |                   18 |          4 |                         18 |
| Coffee Ice Cream |                   18 |          6 |                         18 |
| Coffee Ice Cream |                   19 |          0 |                         19 |
| Coffee Ice Cream |                   19 |          1 |                         19 |
| Coffee Ice Cream |                   19 |          2 |                         19 |
| Coffee Ice Cream |                   19 |          3 |                         19 |
| Coffee Ice Cream |                   19 |          5 |                         19 |
| Coffee Ice Cream |                   19 |          6 |                         19 |
| Coffee Ice Cream |                   20 |          2 |                         20 |
| Coffee Ice Cream |                   20 |          3 |                         20 |
| Coffee Ice Cream |                   20 |          4 |                         20 |
| Coffee Ice Cream |                   20 |          5 |                         20 |
| Coffee Ice Cream |                   20 |          6 |                         20 |
| Coffee Ice Cream |                   21 |          1 |                         21 |
| Coffee Ice Cream |                   21 |          2 |                         21 |
| Coffee Ice Cream |                   21 |          3 |                         21 |
| Coffee Ice Cream |                   21 |          4 |                         21 |
| Coffee Ice Cream |                   21 |          6 |                         21 |
| Coffee Ice Cream |                   22 |          3 |                         22 |
| Coffee Ice Cream |                   23 |          6 |                         23 |
| Pink Lady Apples |                    0 |          4 |                          0 |
| Pink Lady Apples |                    3 |          5 |                          3 |
| Pink Lady Apples |                    5 |          2 |                          5 |
| Pink Lady Apples |                    5 |          5 |                          5 |
| Pink Lady Apples |                    6 |          0 |                          6 |
| Pink Lady Apples |                    6 |          1 |                          6 |
| Pink Lady Apples |                    6 |          2 |                          6 |
| Pink Lady Apples |                    6 |          4 |                          6 |
| Pink Lady Apples |                    6 |          6 |                          6 |
| Pink Lady Apples |                    7 |          0 |                          7 |
| Pink Lady Apples |                    7 |          1 |                          7 |
| Pink Lady Apples |                    7 |          2 |                          7 |
| Pink Lady Apples |                    7 |          4 |                          7 |
| Pink Lady Apples |                    7 |          5 |                          7 |
| Pink Lady Apples |                    7 |          6 |                          7 |
| Pink Lady Apples |                    8 |          0 |                          8 |
| Pink Lady Apples |                    8 |          1 |                          8 |
| Pink Lady Apples |                    8 |          2 |                          8 |
| Pink Lady Apples |                    8 |          3 |                          8 |
| Pink Lady Apples |                    8 |          4 |                          8 |
| Pink Lady Apples |                    8 |          5 |                          8 |
| Pink Lady Apples |                    9 |          0 |                          9 |
| Pink Lady Apples |                    9 |          1 |                          9 |
| Pink Lady Apples |                    9 |          2 |                          9 |
| Pink Lady Apples |                    9 |          3 |                          9 |
| Pink Lady Apples |                    9 |          4 |                          9 |
| Pink Lady Apples |                    9 |          5 |                          9 |
| Pink Lady Apples |                    9 |          6 |                          9 |
| Pink Lady Apples |                   10 |          0 |                         10 |
| Pink Lady Apples |                   10 |          1 |                         10 |
| Pink Lady Apples |                   10 |          2 |                         10 |
| Pink Lady Apples |                   10 |          3 |                         10 |
| Pink Lady Apples |                   10 |          4 |                         10 |
| Pink Lady Apples |                   10 |          5 |                         10 |
| Pink Lady Apples |                   10 |          6 |                         10 |
| Pink Lady Apples |                   11 |          0 |                         11 |
| Pink Lady Apples |                   11 |          1 |                         11 |
| Pink Lady Apples |                   11 |          2 |                         11 |
| Pink Lady Apples |                   11 |          3 |                         11 |
| Pink Lady Apples |                   11 |          4 |                         11 |
| Pink Lady Apples |                   11 |          5 |                         11 |
| Pink Lady Apples |                   11 |          6 |                         11 |
| Pink Lady Apples |                   12 |          0 |                         12 |
| Pink Lady Apples |                   12 |          1 |                         12 |
| Pink Lady Apples |                   12 |          2 |                         12 |
| Pink Lady Apples |                   12 |          3 |                         12 |
| Pink Lady Apples |                   12 |          4 |                         12 |
| Pink Lady Apples |                   12 |          5 |                         12 |
| Pink Lady Apples |                   12 |          6 |                         12 |
| Pink Lady Apples |                   13 |          0 |                         13 |
| Pink Lady Apples |                   13 |          1 |                         13 |
| Pink Lady Apples |                   13 |          2 |                         13 |
| Pink Lady Apples |                   13 |          3 |                         13 |
| Pink Lady Apples |                   13 |          4 |                         13 |
| Pink Lady Apples |                   13 |          5 |                         13 |
| Pink Lady Apples |                   13 |          6 |                         13 |
| Pink Lady Apples |                   14 |          0 |                         14 |
| Pink Lady Apples |                   14 |          2 |                         14 |
| Pink Lady Apples |                   14 |          3 |                         14 |
| Pink Lady Apples |                   14 |          4 |                         14 |
| Pink Lady Apples |                   14 |          5 |                         14 |
| Pink Lady Apples |                   14 |          6 |                         14 |
| Pink Lady Apples |                   15 |          0 |                         15 |
| Pink Lady Apples |                   15 |          2 |                         15 |
| Pink Lady Apples |                   15 |          4 |                         15 |
| Pink Lady Apples |                   15 |          5 |                         15 |
| Pink Lady Apples |                   16 |          0 |                         16 |
| Pink Lady Apples |                   16 |          1 |                         16 |
| Pink Lady Apples |                   16 |          2 |                         16 |
| Pink Lady Apples |                   16 |          4 |                         16 |
| Pink Lady Apples |                   16 |          5 |                         16 |
| Pink Lady Apples |                   16 |          6 |                         16 |
| Pink Lady Apples |                   17 |          2 |                         17 |
| Pink Lady Apples |                   17 |          3 |                         17 |
| Pink Lady Apples |                   17 |          4 |                         17 |
| Pink Lady Apples |                   17 |          5 |                         17 |
| Pink Lady Apples |                   17 |          6 |                         17 |
| Pink Lady Apples |                   18 |          2 |                         18 |
| Pink Lady Apples |                   18 |          3 |                         18 |
| Pink Lady Apples |                   18 |          6 |                         18 |
| Pink Lady Apples |                   19 |          0 |                         19 |
| Pink Lady Apples |                   19 |          1 |                         19 |
| Pink Lady Apples |                   19 |          2 |                         19 |
| Pink Lady Apples |                   19 |          5 |                         19 |
| Pink Lady Apples |                   20 |          0 |                         20 |
| Pink Lady Apples |                   20 |          1 |                         20 |
| Pink Lady Apples |                   20 |          3 |                         20 |
| Pink Lady Apples |                   20 |          4 |                         20 |
| Pink Lady Apples |                   21 |          0 |                         21 |
| Pink Lady Apples |                   21 |          1 |                         21 |
| Pink Lady Apples |                   21 |          2 |                         21 |
| Pink Lady Apples |                   21 |          3 |                         21 |
| Pink Lady Apples |                   21 |          5 |                         21 |
| Pink Lady Apples |                   22 |          0 |                         22 |
| Pink Lady Apples |                   22 |          1 |                         22 |
| Pink Lady Apples |                   22 |          3 |                         22 |
| Pink Lady Apples |                   22 |          5 |                         22 |
| Pink Lady Apples |                   23 |          1 |                         23 |
| Pink Lady Apples |                   23 |          2 |                         23 |
| Pink Lady Apples |                   23 |          3 |                         23 |
| Pink Lady Apples |                   23 |          5 |                         23 |

``` r
mean_hour_apples_icecream=instacart %>%
  filter(product_name == "Pink Lady Apples" | 
      product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_dow) %>%
  summarize(mean_order_hour= mean(order_hour_of_day)) %>%
  select(product_name, order_dow, mean_order_hour) %>%
  pivot_wider(
      names_from = order_dow,
      values_from = mean_order_hour
  ) %>%
  knitr::kable ()
mean_hour_apples_icecream
```

| product\_name    |        0 |        1 |        2 |        3 |        4 |        5 |        6 |
| :--------------- | -------: | -------: | -------: | -------: | -------: | -------: | -------: |
| Coffee Ice Cream | 13.77419 | 14.31579 | 15.38095 | 15.31818 | 15.21739 | 12.26316 | 13.83333 |
| Pink Lady Apples | 13.44118 | 11.36000 | 11.70213 | 14.25000 | 11.55172 | 12.78431 | 11.93750 |
| \#\# Problem 2   |          |          |          |          |          |          |          |

``` r
data("brfss_smart2010")
```

``` r
brfss = brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health" |
           response == "Excellent" |
           response == "Very good" |
           response == "Good" |
           response == "Fair" |
           response == "Poor") %>%
mutate(response = factor(response, labels = c("Poor","Fair","Good","Very good", "Excellent" ))) %>%
select(-location_id, -data_value_footnote_symbol, -data_value_footnote)
brfss
```

    ## # A tibble: 10,625 x 20
    ##     year locationabbr locationdesc class topic question response
    ##    <int> <chr>        <chr>        <chr> <chr> <chr>    <fct>   
    ##  1  2010 AL           AL - Jeffer… Heal… Over… How is … Poor    
    ##  2  2010 AL           AL - Jeffer… Heal… Over… How is … Excelle…
    ##  3  2010 AL           AL - Jeffer… Heal… Over… How is … Good    
    ##  4  2010 AL           AL - Jeffer… Heal… Over… How is … Fair    
    ##  5  2010 AL           AL - Jeffer… Heal… Over… How is … Very go…
    ##  6  2010 AL           AL - Mobile… Heal… Over… How is … Poor    
    ##  7  2010 AL           AL - Mobile… Heal… Over… How is … Excelle…
    ##  8  2010 AL           AL - Mobile… Heal… Over… How is … Good    
    ##  9  2010 AL           AL - Mobile… Heal… Over… How is … Fair    
    ## 10  2010 AL           AL - Mobile… Heal… Over… How is … Very go…
    ## # … with 10,615 more rows, and 13 more variables: sample_size <int>,
    ## #   data_value <dbl>, confidence_limit_low <dbl>,
    ## #   confidence_limit_high <dbl>, display_order <int>,
    ## #   data_value_unit <chr>, data_value_type <chr>, data_source <chr>,
    ## #   class_id <chr>, topic_id <chr>, question_id <chr>, respid <chr>,
    ## #   geo_location <chr>

In 2002, which states were observed at 7 or more locations? What about
in 2010?

``` r
brfss %>%
  filter(year == "2002") %>%
  group_by(locationabbr) %>%
  summarize(
    number_observations = n_distinct(geo_location)) %>%
    filter(number_observations > 6) %>%
  arrange(desc(number_observations))
```

    ## # A tibble: 6 x 2
    ##   locationabbr number_observations
    ##   <chr>                      <int>
    ## 1 PA                            10
    ## 2 MA                             8
    ## 3 NJ                             8
    ## 4 CT                             7
    ## 5 FL                             7
    ## 6 NC                             7

PA, MA, NJ, CT, FL, and NC each were observed at 7 or more locations.

In 2002, which states were observed at 7 or more locations? What about
in 2010?

``` r
brfss %>%
  filter(year == "2010") %>%
  group_by(locationabbr) %>%
  summarize(
    number_observations = n_distinct(geo_location)) %>%
    filter(number_observations > 6) %>%
  arrange(desc(number_observations))
```

    ## # A tibble: 14 x 2
    ##    locationabbr number_observations
    ##    <chr>                      <int>
    ##  1 FL                            41
    ##  2 NJ                            19
    ##  3 TX                            16
    ##  4 CA                            12
    ##  5 MD                            12
    ##  6 NC                            12
    ##  7 NE                            10
    ##  8 WA                            10
    ##  9 MA                             9
    ## 10 NY                             9
    ## 11 OH                             8
    ## 12 CO                             7
    ## 13 PA                             7
    ## 14 SC                             7

FL, NJ, TX, CA, MD, NC, NE, WA, MA, NY, OH, CO, PA, and SC each were
observed at 7 or more locations.

``` r
excellent_data = brfss %>%
  filter(response == "Excellent") %>%
  group_by(year, locationabbr) %>%
  summarise(mean_data = mean(data_value, na.rm = TRUE)) %>%
  select(year, locationabbr, mean_data)
```

``` r
brfss_spaghetti =
  excellent_data %>%
  ggplot(aes(x = year, y = mean_data, group = locationabbr)) +
  geom_line(aes(color = locationabbr)) +
  labs(
    title = "Average value over time within 50 states",
    x = "Year",
    y = "Average Data Value"
  )
brfss_spaghetti
```

![](p8105_hw3_blm2156_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->
\#\# Two-Panel Plot

``` r
two_panel_data = brfss %>%
  filter(topic == "Overall Health" |
           response == "Excellent" |
           response == "Very good" |
           response == "Good" |
           response == "Fair" |
           response == "Poor",
           year == "2006" | 
           year== "2010",
           locationabbr == "NY")
ggplot(two_panel_data, aes(x = response, y = data_value, color = response)) +
  geom_point() +
  facet_grid(. ~ year) +
labs(
    title = "Distribution of data values for 2006 & 2010 by response",
    x = "Response",
    y = "Data Value"
  )
```

![](p8105_hw3_blm2156_files/figure-gfm/unnamed-chunk-12-1.png)<!-- -->
