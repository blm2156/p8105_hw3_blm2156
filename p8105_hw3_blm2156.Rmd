---
title: "p8105_hw3_blm2156"
author: Britney Mazzetta - blm2156
output: github_document
---
# Problem 1
```{r}
library(tidyverse)
library(p8105.datasets)
library(knitr)
data("instacart")
```

## Description of Dataset 
There are `r nrow(instacart)` rows in the instacart dataset. There are `r ncol(instacart)` columns in the instacart dataset. 

There are `r nrow(distinct(instacart, aisle))` distinct aisles in the dataset. 

## # of Aisles and Most Popular Aisle
```{r}
aisle_info = instacart %>% 
  group_by(aisle_id, aisle) %>%
  summarize(n=n()) %>%
  arrange(desc(n))
```
The aisle in which the most items were ordered from is aisle 83 (fresh vegetables), with 150609 orders. The aisle in which the second most items were ordered from is aisle 24 (fresh fruits), with 150473 orders. The aisle in which the third most items were ordered from is aisle 123 (packaged vegetables fruits), with 78493 orders.

## Instacart Plot
```{r}
instacart_plot = filter(aisle_info, n >10000)
ggplot(
  instacart_plot, 
  aes(x = reorder(aisle, -n), y =n)) + 
  geom_point(color = 'blue') +
  theme(axis.text.x = element_text(angle = 90, hjust = 1),
        axis.text = element_text(size = 7.5)) +
  ggtitle("Number of items ordered in each aisle \n(limited to aisles with more than 10,000 items ordered") +
labs(y = "# of Items Ordered",
     x = "Aisle")
```

## 3 Most popular items in each aisle

```{r}
library(knitr)

ranking = instacart %>%
filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") %>%
  group_by(aisle, product_name)%>%
  summarise(n = n()) %>%
  mutate(product_ranking = min_rank(desc(n))) %>% 
  filter(product_ranking < 4) %>%
  knitr::kable()
  ranking
```


```{r}
mean_hour = instacart %>%
filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_hour_of_day, order_dow)%>%
  summarise(n = n()) %>%
  mutate(mean_hour = mean(order_hour_of_day)) %>% 
  knitr::kable()
  mean_hour
  
  
  mean_hour = instacart %>%
filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>%
group_by(product_name, order_hour_of_day, order_dow)%>%
  summarise(mean(order_hour_of_day)) %>%
  knitr::kable()
  mean_hour
  
  
  
mean_hour_apples_icecream=instacart %>%
  filter(product_name == "Pink Lady Apples" | 
      product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_dow) %>%
  summarize(mean_order_hour= mean(order_hour_of_day)) %>%
  select(product_name, order_dow, mean_order_hour) %>%
  pivot_wider(
      names_from = order_dow,
      values_from = mean_order_hour
  ) %>%
  knitr::kable ()
mean_hour_apples_icecream
```

